import { component$, useSignal, useVisibleTask$, useStyles$ } from "@builder.io/qwik";
import type { DocumentHead } from "@builder.io/qwik-city";
import type { RequestHandler } from "@builder.io/qwik-city";
import styles from './styles.css?inline';

export const onGet: RequestHandler = async ({ cacheControl }) => {
  // Control caching for this request for best performance and to reduce hosting costs:
  // https://qwik.builder.io/docs/caching/
  cacheControl({
    // Always serve a cached response by default, up to a week stale
    staleWhileRevalidate: 60 * 60 * 24 * 7,
    // Max once every 5 seconds, revalidate on the server to get a fresh version of this page
    maxAge: 5,
  });
};



export default component$(() => {
  useStyles$(styles);
  const visible = useSignal(false);

  // hide until visible
  // eslint-disable-next-line qwik/no-use-visible-task
  useVisibleTask$(() => {
    visible.value = true;
  });
  return (
    <main>
      <div style={{background: 'grey', width: '100vw', height: '100vh'}}>
        <div style={{margin: 'auto'}}>First View</div>
      </div>
      {visible.value && (
        <div style={{background: 'black', color: 'white'}}>
          {Array(100000).fill(null).map((_, i) => (
            <div key={i}>Hello World</div>
          ))}
        </div>
      )}
    </main>
  );
});

export const head: DocumentHead = {
  title: "Create Qwik App",
  meta: [
    {
      name: "description",
      content: "Generated by create next app",
    },
  ],
};

